"0","# If a single tax were imposed that would reduce the total quantity of groundwater demanded to 500AF, then the tax amount would be the same as the above equilibrium price for groundwater in this market, which would be t* = 199.1489. We can update the demand_gw function to calculate the quantity traded under the new tax as well as the total abatement for each district under the new tax"
"0","demand_gw_tax <- function(P){"
"0","  Qk = 150 - (P*(1/4.5))"
"0","  Qk = ifelse(Qk <= 0, 0, Qk)"
"0","  Ak = 150-Qk"
"0","  Qm = 140 - (P*(1/4))"
"0","  Qm = ifelse(Qm <= 0, 0, Qm)"
"0","  Am = 140-Qm"
"0","  Qa = 220 - (P*(1/3))"
"0","  Qa = ifelse(Qa <= 0, 0, Qa)"
"0","  Aa = 220-Qa"
"0","  Qv = 250 - (P*(1/2))"
"0","  Qv = ifelse(Qv <= 0, 0, Qv)"
"0","  Av = 250-Qv"
"0","  return(tibble(District = c(""Kern"", ""Mojave"", ""Antelope"", ""Ventura""), Q_pol = c(Qk, Qm, Qa, Qv), Abatement = c(Ak, Am, Aa, Av)))"
"0","}"
"0","## Using function to calculate the new quantity demanded by each firm "
"0","quantity_with_tax <- demand_gw_tax(199.1489)"
"0","## Testing to see if it adds up to 500"
"0","# sum(quantity_with_tax$Q_demand) # It does "
"0","knitr::kable(quantity_with_tax, align = ""c"", caption = ""Abatement of Each District with Tax"")"
